/*
   This program is free software; you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation; either version 2 of the License, or
   (at your option) any later version.

   This program is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with this program; if not, write to the Free Software
   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.

   Product name: redemption, a FLOSS RDP proxy
   Copyright (C) Wallix 2010
   Author(s): Christophe Grosjean, Javier Caverni
   Based on xrdp Copyright (C) Jay Sorg 2004-2010

   Unit test to writing RDP orders to file and rereading them

*/

#define BOOST_AUTO_TEST_MAIN
#define BOOST_TEST_DYN_LINK
#define BOOST_TEST_MODULE TestRdesktopInvalidPDU
#include <boost/test/auto_unit_test.hpp>
#include "./test_orders.hpp"

//iso send connexion request len=31
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 31 bytes
//0000 03 00 00 1f 1a e0 00 00 00 00 00 43 6f 6f 6b 69 ...........Cooki
//0010 65 3a 20 6d 73 74 73 68 61 73 68 3d 78 0d 0a    e: mstshash=x..
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=11
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=418
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 418 bytes
//0000 03 00 01 a2 02 f0 80 7f 65 82 01 96 04 01 01 04 ........e.......
//0010 01 01 01 01 ff 30 20 02 02 00 22 02 02 00 02 02 .....0 ...".....
//0020 02 00 00 02 02 00 01 02 02 00 00 02 02 00 01 02 ................
//0030 02 ff ff 02 02 00 02 30 20 02 02 00 01 02 02 00 .......0 .......
//0040 01 02 02 00 01 02 02 00 01 02 02 00 00 02 02 00 ................
//0050 01 02 02 04 20 02 02 00 02 30 20 02 02 ff ff 02 .... ....0 .....
//0060 02 fc 17 02 02 ff ff 02 02 00 01 02 02 00 00 02 ................
//0070 02 00 01 02 02 ff ff 02 02 00 02 04 82 01 23 00 ..............#.
//0080 05 00 14 7c 00 01 81 1a 00 08 00 10 00 01 c0 00 ...|............
//0090 44 75 63 61 81 0c 01 c0 d4 00 04 00 08 00 20 03 Duca.......... .
//00a0 58 02 01 ca 03 aa 0c 04 00 00 28 0a 00 00 31 00 X.........(...1.
//00b0 39 00 35 00 2d 00 31 00 33 00 32 00 2d 00 32 00 9.5.-.1.3.2.-.2.
//00c0 30 00 33 00 2d 00 32 00 31 00 32 00 00 00 04 00 0.3.-.2.1.2.....
//00d0 00 00 00 00 00 00 0c 00 00 00 00 00 00 00 00 00 ................
//00e0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//00f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0100 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0110 00 00 00 00 00 00 00 00 00 00 01 ca 01 00 00 00 ................
//0120 00 00 18 00 07 00 01 00 00 00 00 00 00 00 00 00 ................
//0130 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0140 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0150 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0160 00 00 00 00 00 00 00 00 00 00 04 c0 0c 00 09 00 ................
//0170 00 00 00 00 00 00 02 c0 0c 00 03 00 00 00 00 00 ................
//0180 00 00 03 c0 20 00 02 00 00 00 63 6c 69 70 72 64 .... .....cliprd
//0190 72 00 c0 a0 00 00 72 64 70 64 72 00 00 00 80 80 r.....rdpdr.....
//01a0 00 00                                           ..
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=329
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//Generating client random
//40-bit encryption enabled
//iso send Data PDU len=12
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 12 bytes
//0000 03 00 00 0c 02 f0 80 04 00 01 00 01             ............
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=8
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 8 bytes
//0000 03 00 00 08 02 f0 80 28                         .......(
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=11
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=12
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 12 bytes
//0000 03 00 00 0c 02 f0 80 38 00 00 03 e9             .......8....
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=15
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=12
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 12 bytes
//0000 03 00 00 0c 02 f0 80 38 00 00 03 eb             .......8....
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=15
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=12
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 12 bytes
//0000 03 00 00 0c 02 f0 80 38 00 00 03 ec             .......8....
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=15
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=12
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 12 bytes
//0000 03 00 00 0c 02 f0 80 38 00 00 03 ed             .......8....
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=15
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=95
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 95 bytes
//0000 03 00 00 5f 02 f0 80 64 00 00 03 eb 70 80 50 01 ..._...d....p.P.
//0010 00 00 00 48 00 00 00 bc d1 3a af eb b7 43 bf 1b ...H.....:...C..
//0020 db f2 88 a9 44 be e2 42 f0 13 84 73 b0 38 34 ca ....D..B...s.84.
//0030 38 1b 07 00 e1 25 b6 e0 28 34 df 66 b0 a8 45 9a 8....%..(4.f..E.
//0040 84 a0 2f 42 60 96 69 92 91 2d 65 10 b3 b2 07 8b ../B`.i..-e.....
//0050 8c 16 2d 7e e9 c5 1e 00 00 00 00 00 00 00 00    ..-~...........
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=327
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 327 bytes
//0000 03 00 01 47 02 f0 80 64 00 00 03 eb 70 81 38 48 ...G...d....p.8H
//0010 00 00 00 64 35 a0 97 5d 15 e8 78 ea 18 57 fa 93 ...d5..]..x..W..
//0020 e7 a2 0f 75 e5 fa eb 90 89 5c 80 c3 08 25 2a 31 ...u.....\...%*1
//0030 c3 45 6c 50 df cf 43 61 18 de 5d a8 05 f2 14 85 .ElP..Ca..].....
//0040 a8 7b a5 2e 44 3a 96 e4 50 c1 a0 01 8d bf 18 1a .{..D:..P.......
//0050 88 e1 9d 93 35 4d 85 81 e2 55 ed 46 ba 91 e4 4a ....5M...U.F...J
//0060 47 9c 59 2c 4e e1 1d a0 00 d1 26 60 eb ea f8 d7 G.Y,N.....&`....
//0070 4d 32 fe 59 06 b5 00 13 0a 63 44 5d 36 85 70 f4 M2.Y.....cD]6.p.
//0080 b1 b3 7b ed 9d fd 74 7b 87 25 d9 80 2a f7 4a bb ..{...t{.%..*.J.
//0090 ec ba e3 3e ee 03 2d 86 24 d6 35 76 e6 65 14 1c ...>..-.$.5v.e..
//00a0 3d c1 85 fb 1c 0b e5 33 0f 66 d5 0f 50 75 4e b6 =......3.f..PuN.
//00b0 32 f9 af 9a a5 73 97 a7 21 f9 31 7d 9d c5 7b 75 2....s..!.1}..{u
//00c0 7b 37 88 8c 46 38 cf 1f ba f3 41 16 69 1e f8 db {7..F8....A.i...
//00d0 cc a6 2d d1 d4 b0 f9 75 f8 c2 88 f6 77 25 4c ba ..-....u....w%L.
//00e0 f6 da e4 34 72 45 cc 11 38 7b 3b d8 70 9c 67 a5 ...4rE..8{;.p.g.
//00f0 44 b0 7f 4d b3 04 3e c1 5a da 9b cb 8b 54 a9 99 D..M..>.Z....T..
//0100 5c 88 50 81 6e 3e 84 ef 4d ea 8a 45 00 2f be 43 \.P.n>..M..E./.C
//0110 8b 52 e7 8a 57 38 41 13 55 ad 52 32 6e 9c f8 5a .R..W8A.U.R2n..Z
//0120 06 5d c1 5b 0a 99 58 bf 1e af d9 7e 86 35 30 75 .].[..X....~.50u
//0130 44 a6 08 96 b3 05 76 0c 87 b4 04 9e 41 81 d2 15 D.....v.....A...
//0140 47 c8 4e f6 0f 7a cf                            G.N..z.
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//rdp_connect ok
//Connection successful.
//rdp_loop
//rdp_loop receiving
//rdp_recv
//iso send Data PDU len=61
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 61 bytes
//0000 03 00 00 3d 02 f0 80 64 00 00 03 eb 70 80 2e 08 ...=...d....p...
//0010 00 00 00 c8 79 32 34 2a 6e ed 46 dd 3a 0a 7f 9b ....y24*n.F.:...
//0020 20 98 c6 8b ae 49 e1 e4 aa f3 bf d3 c0 98 96 fe  ....I..........
//0030 c9 d2 9b 46 b7 a4 00 47 fc 88 d1 1d c7          ...F...G.....
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=337
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=165
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 165 bytes
//0000 03 00 00 a5 02 f0 80 64 00 00 03 eb 70 80 96 80 .......d....p...
//0010 00 00 00 13 02 92 00 01 00 00 00 00 00 01 ff 00 ................
//0020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0040 00 48 00 00 00 00 00 00 00 00 00 00 00 00 00 00 .H..............
//0050 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0060 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0070 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
//0080 00 00 00 00 00 00 00 00 00 00 00 0f 00 02 00 78 ...............x
//0090 00 10 00 10 00 31 39 35 2d 31 33 32 2d 32 30 33 .....195-132-203
//00a0 2d 32 31 32 00                                  -212.
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=35
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso recv code=0 length=303
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//receving: 0 bytes
//0000                                                 
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//procees with ShareControl PDU
//RDP packet #1, (type 1)
//rdp_loop recv done
//RDP_PDU_DEMAND_ACTIVE
//DEMAND_ACTIVE(id=0x10002)
//setting desktop size and depth to: 800x600x24
//iso send Data PDU len=445
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 445 bytes
//0000 03 00 01 bd 02 f0 80 64 00 00 03 eb 70 81 ae 38 .......d....p..8
//0010 00 00 00 ce cb 24 fd 80 2c 97 02 4f ec 38 9b 40 .....$..,..O.8.@
//0020 9d 27 51 17 45 59 9b 3e 65 4c f9 e7 71 2f f8 cd .'Q.EY.>eL..q/..
//0030 f0 a6 8b 91 9f 52 88 ec d2 83 8e 86 df bc b3 e7 .....R..........
//0040 f9 46 97 53 51 68 db 0b af 51 46 b8 01 7e 33 16 .F.SQh...QF..~3.
//0050 ea 26 e5 c0 37 9c 99 47 c2 98 cb 14 02 9b cb 12 .&..7..G........
//0060 ba b8 ef 82 df 73 1a b1 cc 60 92 54 f3 3a 0b ac .....s...`.T.:..
//0070 3c f5 9d 0a 65 b2 45 e1 71 81 e7 76 6b c4 34 79 <...e.E.q..vk.4y
//0080 df 75 f3 82 f5 47 af 58 35 6b 1a 2a c4 d6 10 62 .u...G.X5k.*...b
//0090 e1 a1 9b 71 34 6b 5d a8 38 36 9a f5 c4 d3 b1 58 ...q4k].86.....X
//00a0 fe d1 45 9a 5c 1f 11 1f 01 d5 61 12 a0 bc 89 a6 ..E.\.....a.....
//00b0 86 51 96 78 54 9d 62 34 d5 4e 15 66 58 ff 30 a7 .Q.xT.b4.N.fX.0.
//00c0 e7 65 0a 88 58 94 f3 5f 54 f3 de 56 bd eb 19 fc .e..X.._T..V....
//00d0 48 1f 09 7a 29 ca 94 64 c8 0d 87 43 6e 37 ff c9 H..z)..d...Cn7..
//00e0 e6 ba 95 01 7f a1 fb b8 e3 26 2d 65 e2 66 c3 89 .........&-e.f..
//00f0 24 2b 50 3c 4c 92 ca 93 f7 38 82 f4 20 72 57 27 $+P<L....8.. rW'
//0100 ed 89 3b 9f 70 26 ae 05 73 72 8c 38 f9 aa 94 c1 ..;.p&..sr.8....
//0110 2e f8 7b 8b e8 bd e2 32 7f 4c ab b2 a0 be 2d ab ..{....2.L....-.
//0120 72 b7 68 cc 43 25 ce 9a 5b 47 66 8c 9c 13 0c 3b r.h.C%..[Gf....;
//0130 dc e0 a9 05 8f 90 36 2d ce 57 bc c6 8b 1f a4 46 ......6-.W.....F
//0140 58 b9 35 7f ac 47 c8 e8 9f 0c ab 8d 84 6c 27 fa X.5..G.......l'.
//0150 a2 87 97 6d 39 cc 03 8a 8c 35 f3 a9 b4 8c 9c 81 ...m9....5......
//0160 46 ca 82 6c 1d 82 c3 99 9a dd 94 b9 76 f8 d2 ae F..l........v...
//0170 06 9c 69 33 79 2f f3 3f 8c 41 f9 20 2c 97 3e 12 ..i3y/.?.A. ,.>.
//0180 53 19 d0 66 77 b5 38 16 02 cf a5 a7 7c d1 11 29 S..fw.8.....|..)
//0190 ab b3 f0 00 5d bb cb 5a 1c ed bc a0 d9 99 f1 6b ....]..Z.......k
//01a0 8f 15 f9 ff 89 09 90 1a 21 15 d9 f2 d9 54 21 87 ........!....T!.
//01b0 2a 9b b4 f3 7e 76 b3 41 ab b4 42 57 e5          *...~v.A..BW.
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=49
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 49 bytes
//0000 03 00 00 31 02 f0 80 64 00 00 03 eb 70 80 22 08 ...1...d....p.".
//0010 00 00 00 2c 4b 18 6f 85 3f 17 96 02 f2 5a 20 1c ...,K.o.?....Z .
//0020 4c 21 a6 ba f2 14 22 44 51 44 1a 8c 8f f7 27 61 L!...."DQD....'a
//0030 94                                              .
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=53
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 53 bytes
//0000 03 00 00 35 02 f0 80 64 00 00 03 eb 70 80 26 08 ...5...d....p.&.
//0010 00 00 00 a9 7d c3 a8 64 1d 99 f2 80 89 b5 23 0e ....}..d......#.
//0020 6d 8d 62 9c 53 24 0c cf 35 d1 8b 34 d9 56 84 43 m.b.S$..5..4.V.C
//0030 12 f2 c6 25 10                                  ...%.
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//iso send Data PDU len=53
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 53 bytes
//0000 03 00 00 35 02 f0 80 64 00 00 03 eb 70 80 26 08 ...5...d....p.&.
//0010 00 00 00 08 49 6d e4 6a ff 21 ad 3c 7a a1 5d ef ....Im.j.!.<z.].
//0020 5c f5 db 47 57 d4 59 7f 91 2d fd 87 fe 35 32 72 \..GW.Y..-...52r
//0030 fc 19 f7 37 a3                                  ...7.
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//rdp_recv
//ERROR: recv: Connexion ré-initialisée par le correspondant
//rdp_s == NULL
//rdp_recv
//ERROR: Connection closed
//rdp_s == NULL
//rdp_recv
//ERROR: Connection closed
//rdp_s == NULL
//iso send Data PDU len=61
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 61 bytes
//0000 03 00 00 3d 02 f0 80 64 00 00 03 eb 70 80 2e 08 ...=...d....p...
//0010 00 00 00 f7 b7 7a 01 b2 17 d2 02 1b e2 b4 4c ac .....z........L.
//0020 e3 87 3f 5f 14 4f 8a 46 b1 c9 c8 6b 22 3a 83 9c ..?_.O.F...k":..
//0030 74 14 de b9 a0 58 bd 57 1d 84 48 84 9a          t....X.W..H..
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//ERROR: send: Relais brisé (pipe)
//iso send Data PDU len=53
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 53 bytes
//0000 03 00 00 35 02 f0 80 64 00 00 03 eb 70 80 26 08 ...5...d....p.&.
//0010 00 00 00 d2 70 48 06 e4 41 bd d0 4f bc 2c 24 c4 ....pH..A..O.,$.
//0020 cc 12 bc df d0 94 38 7c e2 f2 51 67 40 a6 53 e2 ......8|..Qg@.S.
//0030 3e 10 50 0d 94                                  >.P..
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//ERROR: send: Relais brisé (pipe)
//iso send Data PDU len=53
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 53 bytes
//0000 03 00 00 35 02 f0 80 64 00 00 03 eb 70 80 26 08 ...5...d....p.&.
//0010 00 00 00 99 ad 27 7b 92 51 31 9d 27 02 7a bb 1c .....'{.Q1.'.z..
//0020 13 e2 ae 1e f3 29 0a ee 6f bd 2e 2a b5 0f 4b e8 .....)..o..*..K.
//0030 25 54 ed 5e 3d                                  %T.^=
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//ERROR: send: Relais brisé (pipe)
//rdp_recv
//ERROR: Connection closed
//rdp_s == NULL
//rdp_loop
//rdp_loop receiving
//rdp_recv
//ERROR: Connection closed
//rdp_s == NULL
//rdp_loop recv done
//exit to external loop
//Disconnecting...
//iso send code=128 len=11
//>>>>>>>>>>>>>>>>>>>>>>>>>>
//sending: 11 bytes
//0000 03 00 00 0b 06 80 00 00 00 00 00                ...........

//core/RDP/x224.hpp
#include "../front/front.hpp"

BOOST_AUTO_TEST_CASE(TestSendConnectionPacketsLikeRdesktopByHand)
{
//sending: 31 bytes
//0000 03 00 00 1f 1a e0 00 00 00 00 00 43 6f 6f 6b 69 ...........Cooki
//0010 65 3a 20 6d 73 74 73 68 61 73 68 3d 78 0d 0a    e: mstshash=x..

    Stream stream;
    GeneratorTransport t(
        "\x03\x00\x00\x1F\x1A\xE0\x00\x00\x00\x00\x00\x43\x6f\x6f\x6b\x69"
        "\x65\x3A\x20\x6D\x73\x74\x73\x68\x61\x73\x68\x3D\x78\x0D\x0A", 31);

    recv_x224_connection_request_pdu(&t);

    BOOST_CHECK_EQUAL(t.current, t.len);
    // send_x224_connection_confirm_pdu(this->trans);

    //sending: 418 bytes
    //0000 03 00 01 a2 02 f0 80 7f 65 82 01 96 04 01 01 04 ........e.......
    //0010 01 01 01 01 ff 30 20 02 02 00 22 02 02 00 02 02 .....0 ...".....
    //0020 02 00 00 02 02 00 01 02 02 00 00 02 02 00 01 02 ................
    //0030 02 ff ff 02 02 00 02 30 20 02 02 00 01 02 02 00 .......0 .......
    //0040 01 02 02 00 01 02 02 00 01 02 02 00 00 02 02 00 ................
    //0050 01 02 02 04 20 02 02 00 02 30 20 02 02 ff ff 02 .... ....0 .....
    //0060 02 fc 17 02 02 ff ff 02 02 00 01 02 02 00 00 02 ................
    //0070 02 00 01 02 02 ff ff 02 02 00 02 04 82 01 23 00 ..............#.
    //0080 05 00 14 7c 00 01 81 1a 00 08 00 10 00 01 c0 00 ...|............
    //0090 44 75 63 61 81 0c 01 c0 d4 00 04 00 08 00 20 03 Duca.......... .
    //00a0 58 02 01 ca 03 aa 0c 04 00 00 28 0a 00 00 31 00 X.........(...1.
    //00b0 39 00 35 00 2d 00 31 00 33 00 32 00 2d 00 32 00 9.5.-.1.3.2.-.2.
    //00c0 30 00 33 00 2d 00 32 00 31 00 32 00 00 00 04 00 0.3.-.2.1.2.....
    //00d0 00 00 00 00 00 00 0c 00 00 00 00 00 00 00 00 00 ................
    //00e0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
    //00f0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
    //0100 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
    //0110 00 00 00 00 00 00 00 00 00 00 01 ca 01 00 00 00 ................
    //0120 00 00 18 00 07 00 01 00 00 00 00 00 00 00 00 00 ................
    //0130 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
    //0140 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
    //0150 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................
    //0160 00 00 00 00 00 00 00 00 00 00 04 c0 0c 00 09 00 ................
    //0170 00 00 00 00 00 00 02 c0 0c 00 03 00 00 00 00 00 ................
    //0180 00 00 03 c0 20 00 02 00 00 00 63 6c 69 70 72 64 .... .....cliprd
    //0190 72 00 c0 a0 00 00 72 64 70 64 72 00 00 00 80 80 r.....rdpdr.....
    //01a0 00 00                                           ..

    t.reset(
        "\x03\x00\x01\xa2\x02\xf0\x80\x7f\x65\x82\x01\x96\x04\x01\x01\x04"
        "\x01\x01\x01\x01\xff\x30\x20\x02\x02\x00\x22\x02\x02\x00\x02\x02"
        "\x02\x00\x00\x02\x02\x00\x01\x02\x02\x00\x00\x02\x02\x00\x01\x02"
        "\x02\xff\xff\x02\x02\x00\x02\x30\x20\x02\x02\x00\x01\x02\x02\x00"
        "\x01\x02\x02\x00\x01\x02\x02\x00\x01\x02\x02\x00\x00\x02\x02\x00"
        "\x01\x02\x02\x04\x20\x02\x02\x00\x02\x30\x20\x02\x02\xff\xff\x02"
        "\x02\xfc\x17\x02\x02\xff\xff\x02\x02\x00\x01\x02\x02\x00\x00\x02"
        "\x02\x00\x01\x02\x02\xff\xff\x02\x02\x00\x02\x04\x82\x01\x23\x00"
        "\x05\x00\x14\x7c\x00\x01\x81\x1a\x00\x08\x00\x10\x00\x01\xc0\x00"
        "\x44\x75\x63\x61\x81\x0c\x01\xc0\xd4\x00\x04\x00\x08\x00\x20\x03"
        "\x58\x02\x01\xca\x03\xaa\x0c\x04\x00\x00\x28\x0a\x00\x00\x31\x00"
        "\x39\x00\x35\x00\x2d\x00\x31\x00\x33\x00\x32\x00\x2d\x00\x32\x00"
        "\x30\x00\x33\x00\x2d\x00\x32\x00\x31\x00\x32\x00\x00\x00\x04\x00"
        "\x00\x00\x00\x00\x00\x00\x0c\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xca\x01\x00\x00\x00"
        "\x00\x00\x18\x00\x07\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
        "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\xc0\x0c\x00\x09\x00"
        "\x00\x00\x00\x00\x00\x00\x02\xc0\x0c\x00\x03\x00\x00\x00\x00\x00"
        "\x00\x00\x03\xc0\x20\x00\x02\x00\x00\x00\x63\x6c\x69\x70\x72\x64"
        "\x72\x00\xc0\xa0\x00\x00\x72\x64\x70\x64\x72\x00\x00\x00\x80\x80"
        "\x00\x00", 418);

//        recv_mcs_connect_initial_pdu_with_gcc_conference_create_request(
//            this->trans,
//            &this->client_info,
//            this->channel_list);

//        send_mcs_connect_response_pdu_with_gcc_conference_create_response(
//            this->trans,
//            &this->client_info,
//            this->channel_list,
//            this->server_random,
//            this->encrypt.rc4_key_size,
//            this->pub_mod,
//            this->pri_exp);


}



