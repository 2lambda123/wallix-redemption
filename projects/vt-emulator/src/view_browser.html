<DOCTYPE html>
<html>
<head>
    <title>Terminal</title>
    <meta charset="UTF-8"/>

<style>
#tty-player {
    font-family: monospace, monospace;
    border: 2px solid #285577;
    border-top: 1px solid #4c7899;
    display: inline-block;
    position: relative;

    background-color: #333;
    color: #eee;
}

#tty-player-title {
    background: #285577;
    border-bottom: 1px solid #4c7899;
    color: #fff;
    margin:0;
    font-family: sans-serif;
    font-weight: bold;
    padding: 0.2em;
    line-height: 1;
    height: 1em;
    cursor: default;
}

#tty-player-terminal {
    margin:0;
    cursor: text;
    line-height: initial;
}
</style>
</head>
<body>

<pre id="tty-player">
<!-- <p id="tty-player-title">No Title</p> -->
<!-- <p id="tty-player-terminal">contents</p> -->
</pre>

<script type="text/javascript">

let json ={"lines":68,"columns":117,"title":"No Title","data":[[[{"s":"Script started on jeu. 09 févr. 2017 18:28:51 CET"}]],[[{"s":"                                                 "},{"r":"b","f":0,"b":16777215,"s":"%"},{"r":"","f":16777215,"b":0,"s":"                                                                   "}]],[[{"f":11692056,"s":"[2]"},{"f":1618610,"b":0,"s":"redemption-public/projects/vt-emulator"},{"f":16777215,"b":0,"s":"!"},{"r":"b","f":6842472,"s":"10014"},{"r":"","f":1618456,"s":"$"},{"f":1579186,"s":"(vt100)"},{"f":11692056,"s":"✗"},{"f":16777215,"s":" t         "},{"f":11671576,"s":"~/projects/redemption-public/projects/vt-emulator"}]],[[{"r":"u","f":6260695,"s":"."}]],[[{"r":"","f":16777215,"s":"├── "},{"r":"u","f":6260695,"s":"aa"}]],[[{"r":"","f":16777215,"s":"├── Jamroot"}]],[[{"s":"├── "},{"r":"u","f":6260695,"s":"src"}]],[[{"r":"","f":16777215,"s":"│   ├── "},{"f":11503360,"s":"main.cpp"}]],[[{"f":16777215,"s":"│   ├── "},{"r":"u","f":6260695,"s":"rvt"}]],[[{"r":"","f":16777215,"s":"│   │   ├── "},{"f":11503360,"s":"ansi_rendering.cpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"ansi_rendering.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"character_color.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"character.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"charsets.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"color.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":11503360,"s":"json_rendering.cpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"json_rendering.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":11503360,"s":"screen.cpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"screen.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":6281215,"s":"utf8_decoder.hpp"}]],[[{"f":16777215,"s":"│   │   ├── "},{"f":11503360,"s":"vt_emulator.cpp"}]],[[{"f":16777215,"s":"│   │   └── "},{"f":6281215,"s":"vt_emulator.hpp"}]],[[{"f":16777215,"s":"│   └── "},{"f":11503360,"s":"terminal_browser.cpp"}]],[[{"f":16777215,"s":"├── "},{"r":"u","f":6260695,"s":"test"}]],[[{"r":"","f":16777215,"s":"│   └── "},{"r":"u","f":6260695,"s":"rvt"}]],[[{"r":"","f":16777215,"s":"│       ├── "},{"f":11503360,"s":"test_character_color.cpp"}]],[[{"f":16777215,"s":"│       ├── "},{"f":11503360,"s":"test_character.cpp"}]],[[{"f":16777215,"s":"│       ├── "},{"f":11503360,"s":"test_charsets.cpp"}]],[[{"f":16777215,"s":"│       ├── "},{"f":11503360,"s":"test_screen.cpp"}]],[[{"f":16777215,"s":"│       ├── "},{"f":11503360,"s":"test_utf8_decoder.cpp"}]],[[{"f":16777215,"s":"│       └── "},{"f":11503360,"s":"test_vt_emulator.cpp"}]],[[{"f":16777215,"s":"└── typescript"}]],[[{}]],[[{"s":"5 directories, 23 files"}]],[[{"f":11692056,"s":"[2]"},{"f":1618610,"b":0,"s":"redemption-public/projects/vt-emulator"},{"f":16777215,"b":0,"s":"!"},{"r":"b","f":6842472,"s":"10015"},{"r":"","f":1618456,"s":"$"},{"f":1579186,"s":"(vt100)"},{"f":11692056,"s":"✗"},{"f":16777215,"s":"           "},{"f":11671576,"s":"~/projects/redemption-public/projects/vt-emulator"}]],[[{}]],[[{"f":16777215,"s":"Script done on jeu. 09 févr. 2017 18:28:53 CET"}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]],[[{}]]]}

let pre = document.getElementById("tty-player")

function render(screen)
{
    let rendering_tag = {b: 'b', i: 'i', u: 'u'}

    let elem2html = function(e) {
        let start = ''
        let stop = ''
        if (e.f || e.b) {
            start += '<span style="'
            if (e.b) start += 'background-color:#'+e.b.toString(16)+';'
            if (e.f) start += 'color:#'+e.f.toString(16)
            start += '">'
            stop = '</span>' + stop;
        }
        if (e.r) {
            for (let r of e.r) {
                let tag = rendering_tag[r]
                if (tag) {
                    start += '<'+tag+'>'
                    stop = '</'+tag+'>' + stop;
                }
            }
        }
        return start + (e.s||'') + stop;
    }

    return "<p id='tty-player-title'>" +
        (screen.title||'No Title') +
        "</p><p id='tty-player-terminal'>" +
        screen.data.map(
            (lines) => lines.map(
                (line) => line.map(elem2html).join('')
            ).join('')
        ).join("\n") +
        "</p>"
    ;
}

pre.innerHTML = render(json)

</script>

</body>
</html>
